Vue.config.devtools=UseDebug,Vue.config.debug=UseDebug,Vue.config.silent=!UseDebug,Vue.config.ignoredElements=["app","tutorial","oobe","wallpaper","home","modes","mode","piece","glyph","gild","value","checkbox","toggle","version","howto","icon","chrome","quit","divider","stage","gameover","clears","time","playarea","addtime","board","me","puzzle","hint"];var app=new Vue({el:"#app",data:{serviceWorker:"",storedVersion:0,currentVersion:"4.2.290",deviceHasTouch:!0,allPlayerRanks:AllPlayerRanks,currency:new Currency,timeToMidnight:"24h 0m 0s",isGettingDailyChallenge:!1,getDailyTimeThreshold:864e5,isInNativeAppWebView:!1,wallpaperNames:["square","circle","triangle","hexagon"],splashBoard:!1,currentWallpaper:"",newVersionAvailable:!1,appTutorialUserHasSeen:!1,appTutorialCurrentStepIndex:0,appTutorialSteps:TutorialSteps,appTutorialBoardPieces:constructLevel("010013110020010303112100220221213211102001200313120",!0),appTutorialIsInPlay:!1,appTutorialMePiece:new PieceObject({color:"var(--color2)"}),appNotificationMessage:"",appSettingsAddBonusToScoreInterval:null,appSettingsModes:Modes,appSettingsEnableEconomy:!0,appSettingsCurrentGameMode:null,appSettingsInfiniteMode:null,appIsBeingReset:!1,appSettingsSoundFX:new Howl({src:"./audio/phts.mp3",volume:.05}),appSettingsWinFX:new Howl({src:"./audio/triumph.mp3",volume:.05}),appSettingsLevelUpFX:new Howl({src:"./audio/levelup.mp3",volume:.07}),appSettingsSadFX:new Howl({src:"./audio/sadsound.mp3",volume:.1}),userSettingsMusicVolume:.15,appSettingsThemeSong:new Howl({src:"./audio/themesong.m4a",volume:0,loop:!0,id:"theme"}),appSettingsHardcoreEmoji:"ðŸ¤¯",appSettingsHardcoreFinishedEmoji:"ðŸ¤¯",appSettingsSaveSettings:!0,appSettingsModeIntervalIncrement:100,appSettingsNumberOfHighScoresShown:5,appSettingsPieceSize:10,appSettingsScoreTwinIncrement:10,appSettingsScoreSiblingIncrement:20,appSettingsShowSimpleRankPlaques:!1,appSettingsThemes:Themes,appSettingsTotalNumberOfBoardPieces:16,appSettingsBoardGridSize:4,appVisualStateShowPageHighScores:!1,appVisualStateShowPageChallenge:!1,appVisualStateShowPageCredits:!1,appVisualStateShowPageGameOver:!1,appVisualStateShowPageHome:!0,appVisualStateShowPageOOBE:!1,appVisualStateShowPageHowToPlay:!1,appVisualStateShowPageAchievements:!1,appVisualStateShowPageSettings:!1,appVisualStateShowPageManageCurrency:!1,appVisualStateShowGameOverContent:!0,appVisualStateShowElementHint:!1,appVisualStateShowNotification:!1,appVisualStateShowElementFlyaway:!1,appVisualStateShowNewHighScoreElement:!1,appVisualStateIsAddingBonusTime:!1,gameConfettiCount:0,gameCurrentIsPaused:!0,gameCurrentIsGameOver:!0,gameDailyChallenge:new AllLevelsObject({}),gameCurrentIsGameDailyChallenge:!1,gameDailyChallengeAlreadyScored:!1,gameDailyChallengeHasBeenStarted:!1,gameCurrentAllLevels:[],gameCurrentUpdatedCurrencyDeltas:[],gameCurrentLevel:new SingleLevelObject({}),gameCurrentMePiece:{shape:"square"},gameCurrentBoardPieces:[],gameCurrentJustRankedUp:!1,gameCurrentBoardScore:0,gameCurrentTotalScore:0,gameLastHighScore:new ScoreObject({}),gameScoreToShare:new ScoreObject({}),gameCurrentStartingTime:61e3,gameCurrentTimer:61e3,gameCurrentNumberOfClears:0,gameCurrentNumberOfPerfectMatches:0,gameCurrentIsUserGuessWrong:!1,gameCurrentNumberOfFails:0,gameCurrentNumberOfMisses:0,gameCurrentHasBonusTimeHintDisplayed:!1,gameCurrentHintText:"Select pieces that share <b>at least 2</b> of my attributes: color, shape, or pattern.",gameCurrentHasAnyPieceEverBeenSelected:!1,gameLikenessNudgeHasBeenShown:!1,gameClickMeNudgeHasBeenShown:!1,userSettingsUseCats:!1,userDailyLevel:0,userHighScoresInfinite:[],userHighScoresEasy:[],userRank:0,userNumberOfPerfectBasicGames:0,tempPerfectBasicGames:0,userSettingsActionItems:ActonItems,userSettingsUseAltPatterns:!1,userSettingsUseHints:!0,userSettingsUseSoundFX:!0,userSettingsPlayMusic:!0,userSettingsUseDarkMode:!1,userCurrency:Currencies,userSettingsUseHardCoreMode:!1,usersModeBeforeDailyChallenge:null,userTutorialCheckCount:0,documentCssRoot:document.querySelector(":root")},methods:{NewGame(){note("NewGame() called"),this.gameCurrentAllLevels=[],this.NewBoard(),this.userHighScoresEasy.forEach((e=>{e.isCurrent=!1})),this.userHighScoresInfinite.forEach((e=>{e.isCurrent=!1})),this.gameCurrentUpdatedCurrencyDeltas=0,this.appVisualStateShowNewHighScoreElement=!1,this.tempPerfectBasicGames=this.userNumberOfPerfectBasicGames,this.gameCurrentTotalScore=0,this.gameCurrentIsGameOver=!1},ResetApp(){note("NewGame() called"),window.confirm("Are you sure you want to reset the entire app? Everything will be lost!")&&(this.appIsBeingReset=!0,localStorage.clear(),window.location.reload())},CheckBoard(){note("CheckBoard() called"),this.appVisualStateShowElementHint=!1,this.gameCurrentIsUserGuessWrong=!1;let e=0,t=0;if(this.gameClickMeNudgeHasBeenShown=!0,!this.gameCurrentIsGameOver){let a=!0;this.gameCurrentBoardPieces.forEach((s=>{(s.isMatch&&!s.isSelected||!s.isMatch&&s.isSelected)&&(a=!1),s.isMatch&&(e++,s.isFullMatch?t+=this.appSettingsScoreTwinIncrement:t+=this.appSettingsScoreSiblingIncrement)})),0==e&&(t=this.appSettingsScoreTwinIncrement+this.appSettingsScoreSiblingIncrement),a?(this.gameLikenessNudgeHasBeenShown=!0,this.gameCurrentTotalScore=this.gameCurrentTotalScore+t,this.appVisualStateShowElementHint=!1,this.gameCurrentHasAnyPieceEverBeenSelected=!0,0!==this.gameCurrentNumberOfMisses||this.GetModeById("infinite").isSelected||(this.gameCurrentNumberOfPerfectMatches++,this.AddTimeBonus()),this.gameCurrentNumberOfClears++,this.gameCurrentLevel.completed=!0,this.NewBoard()):this.appSettingsEnableEconomy&&this.userSettingsActionItems[0].count>0?(this.IdentifyMismatches(),this.userSettingsActionItems[0].count--):(this.gameCurrentNumberOfMisses>=1&&(this.appVisualStateShowElementHint=!0,this.gameCurrentHintText=0===e?"Some levels have zero matches.":1===e?"There is only <b>"+e+"</b> piece like me.":"There are a total of <b>"+e+"</b> pieces like me.",this.userSettingsUseHints&&this.IdentifyMismatches()),this.gameCurrentNumberOfMisses++,this.gameCurrentNumberOfFails++,window.setTimeout((function(){app.gameCurrentIsUserGuessWrong=!0}),5))}},RemoveConfetti(){note("RemoveConfetti() called");let e=document.getElementsByTagName("confetti");for(let t=e.length-1;t>=0;t--)document.body.removeChild(e[t])},CreateConfetti(e=null,t=null){note("CreateConfetti() called"),this.RemoveConfetti(),t=null===t?this.userRank:t;let a=document.getElementsByTagName("app")[0],s=a.clientWidth,r=t!==this.getLastRank.rank;null!==t&&t===this.getLastRank.rank&&(r=!1);for(let t=0;t<s;t++){let t=document.createElement("confetti"),s=r?this.getCurrentPlayerRank.hue:getRandomInt(0,360);null!==e&&r&&(s=e);let i=r?getRandomInt(50,100):60;t.style.setProperty("left",getRandomInt(0,a.clientWidth)+(window.innerWidth-a.clientWidth)/2+"px"),t.style.setProperty("transition-duration",getRandomInt(1600,3001)+"ms"),t.style.setProperty("transition-delay",getRandomInt(0,800)+"ms"),t.style.setProperty("background-color","hsl("+s+",80%, "+i+"%)"),t.style.setProperty("rotate",NaN);let n=getRandomInt(40,100)/10,o=getRandomInt(40,100)/10;t.style.setProperty("width",n+"px"),t.style.setProperty("height",o+"px"),document.body.appendChild(t)}window.setTimeout((function(){let e=document.getElementsByTagName("confetti");for(let t=0;t<e.length;t++){const a=e[t];a.style.setProperty("translate",parseInt(getRandomInt(-20,20))+"px "+parseInt(document.body.clientHeight-a.clientHeight+20)+"px"),a.style.setProperty("rotate",getRandomInt(-360,360)+"deg"),a.className="drop"}}),this.appVisualStateShowPageGameOver?300:10)},SetUserBasedOnRank(e,t=!1){note("SetUserBasedOnRank() called"),this.userRank=e;let a=this.allPlayerRanks.find((t=>t.rank===e));this.documentCssRoot.style.setProperty("--rankHue",a.hue),t&&(this.CreateConfetti(),this.GetDailyChallenge()),localStorage.setItem("userRank",this.userRank)},CalculateDailyChallengeTotalScore(){note("CalculateDailyChallengeTotalScore() called");let e=0;return this.gameDailyChallenge.allLevels.forEach(((t,a)=>{let s=0,r=0;t.board.forEach(((e,t)=>{e.isMatch&&(r++,e.isFullMatch?s+=this.appSettingsScoreTwinIncrement:s+=this.appSettingsScoreSiblingIncrement)})),0===r&&(s=this.appSettingsScoreTwinIncrement+this.appSettingsScoreSiblingIncrement),e+=s})),e},NewBoard(){note("NewBoard() called"),this.AdjustPieceSizeBasedOnViewport(),this.gameCurrentBoardScore=0,this.gameCurrentNumberOfMisses=0;let e=null;this.gameDailyChallengeHasBeenStarted&&this.gameDailyChallenge.allLevels.forEach(((t,a)=>{null!==e||t.completed||(error(a),e=t)}));let t="infinite"!==this.GetCurrentGameMode().id&&this.gameCurrentAllLevels.length===this.getCurrentPlayerRank.levels;t||(this.gameCurrentBoardPieces=[]),null===e&&t?this.EndGame():(null===e&&(e=constructLevel(createLevelSource(),!0)),this.gameCurrentMePiece=e.me,this.gameCurrentLevel=e,this.gameCurrentAllLevels.push(this.gameCurrentLevel),this.userSettingsUseSoundFX&&(this.appSettingsSoundFX.volume(.05),window.setTimeout((function(){app.appSettingsSoundFX.play()}),236)),e.board.forEach(((t,a)=>{t.delay=40*(e.board.length-a),this.gameCurrentBoardPieces.push(t),window.setTimeout((function(){t.hasDropped=!0}),t.delay)})))},TogglePieceSelection(e){if(note('TogglePieceSelection() called for: " this.gameCurrentBoardPieces['+this.gameCurrentBoardPieces.indexOf(e)+']"'),this.appVisualStateShowElementHint=!1,e.nudge=!1,!this.gameLikenessNudgeHasBeenShown){let t=0;t=e.color===this.gameCurrentMePiece.color?parseInt(t+1):t,t=e.backgroundImage===this.gameCurrentMePiece.backgroundImage?parseInt(t+1):t,t=e.shape===this.gameCurrentMePiece.shape?parseInt(t+1):t,t<2&&(this.appVisualStateShowElementHint=!0,this.gameCurrentHintText="Select pieces that share <b>at least 2</b> of my attributes: color, shape, or pattern."),this.gameLikenessNudgeHasBeenShown=!0}null!=navigator.vibrate&&navigator.vibrate(100),this.gameCurrentIsGameOver||(e.isSelected=!e.isSelected,this.gameCurrentHasAnyPieceEverBeenSelected=!0)},ShareApp(){let e={title:"Like Me?",text:"Check out this fun game I've been playing!",url:"https://bigtentgames.com/likeme.html"};navigator.share?navigator.share(e):(e="https://bigtentgames.com/likeme.html",this.appVisualStateShowNotification=!0,this.appNotificationMessage="Copied game link to the clipboard.",navigator.clipboard.writeText(e))},SetScoreForSharingAndShare(e,t,a=!1){note("SetScoreForSharingAndShare() called"),this.appVisualStateIsAddingBonusTime||(this.appVisualStateShowNotification=!1,""===e.modeId&&(e.modeId=t.id,e.modeName=t.name,e.numberOfPerfectClears=this.gameCurrentNumberOfPerfectMatches),this.gameScoreToShare=e,this.appVisualStateShowNotification?window.setTimeout((function(){app.ShareScore(a)}),200):app.ShareScore(a))},ShareScore(e=!1){note("ShareScored() called");let t=["â–¨ ","â–² ","â—¯ "].sort((()=>Math.random()-.5)).join(""),a=this.userSettingsUseHardCoreMode?"Hardcore Mode":this.gameScoreToShare.modeName,s=`${t}${this.gameScoreToShare.isDaily?"Daily - "+this.GetMonthAndDay(this.gameScoreToShare.dailyDate):a}\n${e?"I just unlocked "+this.getCurrentPlayerRank.name+"!":'"'+this.GetRankById(this.gameScoreToShare.rankId).name+'"'}\n${this.NumberWithCommas(this.gameScoreToShare.value)} pts - ${this.gameScoreToShare.numberOfClears} lvl${1===this.gameScoreToShare.numberOfClears?"":"s"} ${this.gameScoreToShare.numberOfPerfectClears>0?"("+this.gameScoreToShare.numberOfPerfectClears+" perfect)":""}`;if(announce(s),navigator.share){let e={text:s};navigator.share(e)}else this.appVisualStateShowNotification=!0,this.appNotificationMessage=this.gameLastHighScore.isDaily?"Daily challenge results copied to the clipboard.":"Game results copied to the clipboard.",navigator.clipboard.writeText(s)},GiveFeedback(){window.location="mailto:bigtentgames@icloud.com?subject=Feedback - Like Me v"+this.currentVersion},RestartGame(){note("RestartGame() called"),this.gameCurrentStartingTime=this.appSettingsCurrentGameMode.starttime,this.gameCurrentTimer=this.GetModeById("infinite").isSelected?0:this.gameCurrentStartingTime,this.gameCurrentNumberOfFails=0,this.gameCurrentNumberOfClears=0,this.gameCurrentNumberOfPerfectMatches=0,this.appVisualStateShowNotification=!1,this.appVisualStateShowPageHome=!1,this.appVisualStateShowPageGameOver=!1,this.appVisualStateShowElementHint=!1,this.gameCurrentIsPaused=!1,this.gameCurrentHintText="Select pieces that share <b>at least two</b> of my attributes (color, shape, pattern).",this.gameCurrentHasAnyPieceEverBeenSelected=!1,this.NewGame()},SelectMode(e){note('SelectMode(mode) called for:  "'+e.name+'"'),this.gameCurrentBoardPieces=[],this.appSettingsModes.forEach((t=>{t.isSelected=e===t})),this.appSettingsCurrentGameMode=e},GetCurrentGameMode(){note("GetCurrentGameMode() called");let e=null;return this.appSettingsModes.forEach((t=>{t.isSelected&&(e=t)})),null===e&&(this.SelectMode(this.GetModeById("normal")),e=this.appSettingsCurrentGameMode),e},GetModeById(e){note('GetModeById(_id) called for: "'+e+'"');let t={name:"no name"};if(this.appSettingsModes.forEach((a=>{a.id===e&&(t=a)})),null!=t)return t},GetRankById(e){return this.allPlayerRanks.find((t=>t.rank===e))},SelectTheme(e){note('SelectTheme(theme) called for: "'+e.name+'"'),this.appSettingsThemes.forEach((t=>{t.isSelected=e==t})),this.documentCssRoot.style.setProperty("--color1",e.color1),this.documentCssRoot.style.setProperty("--color2",e.color2),this.documentCssRoot.style.setProperty("--color3",e.color3),this.documentCssRoot.style.setProperty("--color3contrast",e.color3contrast),this.documentCssRoot.style.setProperty("--darkBlendMode",e.darkBlendMode),this.documentCssRoot.style.setProperty("--darkPatternOpacity",e.darkPatternOpacity),this.userSettingsUseDarkMode?this.documentCssRoot.style.setProperty("--patternHSL",e.darkPatternHSL):this.documentCssRoot.style.setProperty("--patternHSL","0, 0%, 100%"),localStorage.setItem("userSettingsTheme",JSON.stringify(e.name)),this.GetRandomWallpaper()},GetCurrentTheme(){return note("GetCurrentTheme() called"),this.appSettingsThemes.filter((e=>e.isSelected))[0]},UpdateApp(){this.appVisualStateShowPageHome&&(this.timeToMidnight=this.GetTimeUntilMidnight(),this.GetTimeUntilMidnightInMS()<this.getDailyTimeThreshold&&this.GetTimeUntilMidnightInMS()>this.getDailyTimeThreshold-1e3&&this.GetDailyChallenge()),this.gameCurrentIsPaused||this.appVisualStateShowPageGameOver||(0===this.gameCurrentNumberOfClears&&0===this.userHighScoresEasy.length&&(this.appSettingsInfiniteMode.isSelected||this.gameLikenessNudgeHasBeenShown||this.appSettingsCurrentGameMode.starttime-this.gameCurrentTimer!=7e3?this.appSettingsInfiniteMode.isSelected&&!this.gameLikenessNudgeHasBeenShown&&7e3===this.gameCurrentTimer&&(this.appVisualStateShowElementHint=!0,this.gameCurrentHintText="Select pieces that share <b>at least 2</b> of my attributes: color, shape, or pattern.",this.gameLikenessNudgeHasBeenShown=!0):(this.appVisualStateShowElementHint=!0,this.gameCurrentHintText="Select pieces that share <b>at least 2</b> of my attributes: color, shape, or pattern.",this.gameLikenessNudgeHasBeenShown=!0),(!this.appSettingsInfiniteMode.isSelected&&!this.appVisualStateShowElementHint&&!this.gameClickMeNudgeHasBeenShown&&this.appSettingsCurrentGameMode.starttime-this.gameCurrentTimer>=25e3&&this.gameCurrentTimer%1e3==0||this.appSettingsInfiniteMode.isSelected&&!this.appVisualStateShowElementHint&&!this.gameClickMeNudgeHasBeenShown&&this.gameCurrentTimer>=25e3&&this.gameCurrentTimer%1e4==0)&&(this.appVisualStateShowElementHint=!0,this.gameCurrentHintText="Remember to click the Me piece to check your work and move to the next level.",this.gameClickMeNudgeHasBeenShown=!0)),this.gameCurrentTimer>0||this.appSettingsInfiniteMode.isSelected&&!this.gameCurrentIsGameOver?this.appSettingsInfiniteMode.isSelected?this.gameCurrentTimer=parseInt(this.gameCurrentTimer)+parseInt(this.appSettingsModeIntervalIncrement):this.gameCurrentTimer=this.gameCurrentTimer-this.appSettingsModeIntervalIncrement:this.gameCurrentIsGameOver||this.EndGame())},GetMsToTime(e){var t=(e=(e-e%1e3)/1e3)%60,a=(e=(e-t)/60)%60,s=(e-a)/60;return(0!=s?s+":":"")+(0!=a?a:"")+(":"+("0"+t).slice(-2))},GetMsToHMS(e){var t=(e-e%1e3)/1e3,a=t%60,s=(t=(t-a)/60)%60,r=(t-s)/60;return(0!=r?r+"h ":"")+(0!=s?s+"m ":"")+(a+"s")},DateDiffInDays:(e=new Date,t=new Date("7/30/2023"))=>(_number=Math.round((e-t)/864e5),_number),GetTimeUntilMidnightInMS(){var e=new Date;return new Date(e.getFullYear(),e.getMonth(),e.getDate()+1,0,0,0)-e},GetTimeUntilMidnight(){return this.GetMsToHMS(this.GetTimeUntilMidnightInMS())},AwardCurrency(){if(note("AwardCurrency() called"),this.appSettingsEnableEconomy&&(this.gameCurrentUpdatedCurrencyDeltas=[],this.appSettingsEnableEconomy&&this.getNormalModeComputed.isSelected)){let e=0;this.gameCurrentNumberOfClears===this.getCurrentPlayerRank.levels&&(e+=1e3);for(let t=0;t<this.gameCurrentNumberOfClears;t++)e+=10;this.gameCurrentUpdatedCurrencyDeltas.push({currency:this.userCurrency[0],delta:e}),this.userCurrency[0].count=this.userCurrency[0].count+e,this.userCurrency[0].count>this.userCurrency[0].maxCount&&(this.userCurrency[0].count,this.userCurrency[0].maxCount)}},EndGame(){note("EndGame() called");let e=new ScoreObject({value:this.gameCurrentTotalScore,isDaily:this.gameCurrentIsGameDailyChallenge,modeId:this.GetCurrentGameMode().id,rankId:this.getCurrentPlayerRank.rank,modeName:this.GetCurrentGameMode().name,numberOfClears:this.gameCurrentNumberOfClears});if(this.appVisualStateShowPageGameOver=!0,this.AwardCurrency(),this.getNormalModeComputed.isSelected){if(e.totalPossibleClears=this.getCurrentPlayerRank.levels,e.numberOfPerfectClears=this.gameCurrentNumberOfPerfectMatches,e.numberOfPerfectClears===e.totalPossibleClears){this.userNumberOfPerfectBasicGames++,this.tempPerfectBasicGames=this.userNumberOfPerfectBasicGames;let e=3;this.CreateConfetti(),this.userSettingsUseSoundFX&&(this.appSettingsWinFX.volume(.05),this.appSettingsWinFX.play()),this.userNumberOfPerfectBasicGames===e&&(this.getCurrentPlayerRank!==this.getLastRank&&(this.userRank=this.userRank+1,this.SetUserBasedOnRank(this.userRank,!0),this.userNumberOfPerfectBasicGames=0),this.userSettingsUseSoundFX&&(this.appSettingsLevelUpFX.volume(.075),this.appSettingsLevelUpFX.play()),this.gameCurrentJustRankedUp=!0)}else this.userSettingsUseHardCoreMode&&this.userNumberOfPerfectBasicGames<3&&(this.userNumberOfPerfectBasicGames=0,e.numberOfPerfectClears=0,this.tempPerfectBasicGames=0);e.numberOfPerfectClears!==e.totalPossibleClears&&this.userSettingsUseSoundFX&&(this.appSettingsSadFX.volume(.1),this.appSettingsSadFX.play()),localStorage.setItem("userRank",this.userRank),localStorage.setItem("userNumberOfPerfectBasicGames",this.userNumberOfPerfectBasicGames)}this.gameCurrentIsGameDailyChallenge&&(e.dailyDate=this.gameDailyChallenge.date),this.GetModeById("normal").isSelected?(this.userHighScoresEasy.push(e),e===this.userScoresHighEasyByValue[0]&&0!==e.value&&(this.appVisualStateShowNewHighScoreElement=!0),localStorage.setItem("userHighScoresEasy",JSON.stringify(this.userHighScoresEasy))):this.GetModeById("infinite").isSelected&&(this.userHighScoresInfinite.push(e),localStorage.setItem("userHighScoresInfinite",JSON.stringify(this.userHighScoresInfinite))),e.isCurrent=!0,this.gameLastHighScore=e,this.gameScoreToShare=this.gameLastHighScore,this.AddBonusToScore(),this.gameCurrentLevel.completed=!0,this.gameCurrentIsGameDailyChallenge=!1,this.GetDailyChallenge(),this.CheckForServiceWorkerUpdate(),this.gameCurrentIsGameOver=!0,this.gameDailyChallengeHasBeenStarted=!1,this.appVisualStateShowPageChallenge=!1,this.HandleOnPageHideEvent(!1)},SetState(){this.gameCurrentTimer=3e3},HandleAddBonusToScoreInterval(){let e=1e3/(this.gameCurrentTimer/1e3);e=e>100?100:e,this.appVisualStateIsAddingBonusTime=!0,this.appSettingsAddBonusToScoreInterval=window.setInterval((function(){app.gameCurrentTimer>0?(app.gameCurrentTotalScore++,app.gameLastHighScore.value=app.gameCurrentTotalScore,app.gameCurrentTimer=app.gameCurrentTimer-1e3):(app.gameLastHighScore===app.userScoresHighEasyByValue[0]&&(app.appVisualStateShowNewHighScoreElement=!0),localStorage.setItem("userHighScoresEasy",JSON.stringify(app.userHighScoresEasy)),window.clearInterval(app.appSettingsAddBonusToScoreInterval),app.appVisualStateIsAddingBonusTime=!1)}),e)},AddBonusToScore(){note("AddBonusToScore() called"),this.gameCurrentTimer>0&&this.gameLastHighScore.isDaily&&this.gameCurrentNumberOfClears===this.gameDailyChallenge.allLevels.length&&(this.appVisualStateIsAddingBonusTime=!0,window.setTimeout(this.HandleAddBonusToScoreInterval,1e3))},CheckIfUserHasScoredDailyChallenge(e=!1){return note("CheckIfUserHasScoredDailyChallenge() called"),this.gameDailyChallengeAlreadyScored=!1,_today=this.FormatDate(new Date),this.userHighScoresEasy.forEach((e=>{e.isDaily&&void 0!==e.dailyDate&&this.FormatDate(e.dailyDate)===_today&&(this.gameDailyChallengeAlreadyScored=!0)})),this.gameDailyChallengeAlreadyScored},ToggleZenMode(){note("ToggleZenMode() called"),this.getCurrentGameModeComputed===this.getInfiniteModeComputed?this.SelectMode(this.getNormalModeComputed):this.SelectMode(this.getInfiniteModeComputed)},SetUseHardCoreModeToTrue(e){if(note("SetUseHardCoreModeToTrue(event) called"),!this.userSettingsUseHardCoreMode){window.confirm("Are you sure you want to enable Hardcore Mode? This will reset your ranks and cannot be undone.")&&(e.stopPropagation(),e.preventDefault(),this.userSettingsUseHardCoreMode=!0,this.SetUserBasedOnRank(0),this.userNumberOfPerfectBasicGames=0,this.CreateConfetti()),localStorage.setItem("userSettingsUseHardCoreMode",this.userSettingsUseHardCoreMode)}},SetUseHardCoreModeToFalse(){note("SetUseHardCoreModeToFalse(event) called"),this.userSettingsUseHardCoreMode=!1,this.userNumberOfPerfectBasicGames=0,this.SetUserBasedOnRank(0),localStorage.setItem("userSettingsUseHardCoreMode",this.userSettingsUseHardCoreMode)},ToggleUsingHints(e){note("ToggleUsingHints(event) called"),e.stopPropagation(),e.preventDefault(),this.userSettingsUseHints=!this.userSettingsUseHints,this.userSettingsUseHints||this.gameCurrentBoardPieces.forEach((e=>{e.nudge=!1})),localStorage.setItem("userSettingsUseHints",this.userSettingsUseHints)},ToggleUsingCats(e){note("ToggleUsingCats(event) called"),null!=e&&(e.stopPropagation(),e.preventDefault()),this.userSettingsUseCats=!this.userSettingsUseCats,localStorage.setItem("userSettingsUseCats",this.userSettingsUseCats),this.GetRandomWallpaper()},ToggleUsingAltPattern(e){note("ToggleUsingAltPattern(event) called"),null!=e&&(e.stopPropagation(),e.preventDefault()),this.userSettingsUseAltPatterns=!this.userSettingsUseAltPatterns,localStorage.setItem("userSettingsUseAltPatterns",this.userSettingsUseAltPatterns)},ToggleUsingSound(e){note("ToggleUsingSound(event) called"),e.stopPropagation(),e.preventDefault(),this.userSettingsUseSoundFX=!this.userSettingsUseSoundFX,localStorage.setItem("userSettingsUseSoundFX",this.userSettingsUseSoundFX)},TogglePlayingMusic(e){note("TogglePlayingMusic(event) called"),e.stopPropagation(),e.preventDefault(),this.userSettingsPlayMusic=!this.userSettingsPlayMusic,this.appSettingsThemeSong.playing()||"loaded"!==this.appSettingsThemeSong.state()||this.appSettingsThemeSong.play(),this.userSettingsPlayMusic?this.appSettingsThemeSong.fade(0,this.userSettingsMusicVolume,1e3):this.appSettingsThemeSong.fade(this.userSettingsMusicVolume,0,1e3),localStorage.setItem("userSettingsPlayMusic",this.userSettingsPlayMusic)},ToggleUsingDarkMode(e){note("ToggleUsingDarkMode(event) called"),null!=e&&(e.stopPropagation(),e.preventDefault()),this.userSettingsUseDarkMode=!this.userSettingsUseDarkMode,this.SelectTheme(this.GetCurrentTheme()),document.getElementById("themeColor").content=this.userSettingsUseDarkMode?"#000000":"#f0f0f0",localStorage.setItem("userSettingsUseDarkMode",this.userSettingsUseDarkMode)},ToggleGamePause(e,t){note("ToggleGamePause(event, "+t+") called"),null!=e&&(e.stopPropagation(),e.preventDefault()),this.gameCurrentIsPaused=t,localStorage.setItem("gameCurrentIsPaused",this.gameCurrentIsPaused)},ResetModalContentScrollPositions(){note("ResetModalContentScrollPositions() called");let e=document.getElementsByTagName("content");for(let t=0;t<e.length;t++){e[t].scroll({top:0})}},ToggleChallenge(e,t){note("ToggleChallenge(event, value) called"),null!=e&&(e.stopPropagation(),e.preventDefault()),this.ResetModalContentScrollPositions(),this.appVisualStateShowPageChallenge=t},ToggleShowStoreOn(e){note("ToggleShowHomeOn(event) called"),this.appSettingsEnableEconomy&&(e.stopPropagation(),e.preventDefault(),this.appVisualStateShowPageManageCurrency=!this.appVisualStateShowPageManageCurrency)},ToggleShowHomeOn(e){note("ToggleShowHomeOn(event) called"),e.stopPropagation(),e.preventDefault(),this.RemoveConfetti(),this.appVisualStateShowPageGameOver=!1,this.appVisualStateShowPageHome=!0,null!==this.usersModeBeforeDailyChallenge&&(this.SelectMode(this.usersModeBeforeDailyChallenge),this.usersModeBeforeDailyChallenge=null),this.gameCurrentJustRankedUp&&this.getCurrentPlayerRank===this.getLastRank&&this.userNumberOfPerfectBasicGames>=3&&this.ToggleAchievements(e,!0),this.gameCurrentJustRankedUp=!1},ToggleHowToPlay(e,t){note("ToggleHowToPlay(event, value) called"),void 0!==e&&(e.stopPropagation(),e.preventDefault()),this.ResetModalContentScrollPositions(),this.appTutorialIsInPlay=!0},ToggleOOBE(e,t){note("ToggleOOBE(event, value) called"),null!=e&&(e.stopPropagation(),e.preventDefault()),this.ResetModalContentScrollPositions(),this.appVisualStateShowPageOOBE=t},ToggleHighScores(e,t){note("ToggleHighScores(event, value) called"),e.stopPropagation(),e.preventDefault(),this.ResetModalContentScrollPositions(),this.appVisualStateShowPageGameOver=!1,this.appVisualStateShowPageHome=!0,this.appVisualStateShowPageHighScores=t},ToggleAchievements(e,t){note("ToggleAchievements(event, value) called"),null!=e&&(e.stopPropagation(),e.preventDefault()),this.ResetModalContentScrollPositions(),this.appVisualStateShowPageGameOver=!1,this.appVisualStateShowPageHome=!0,this.appVisualStateShowPageAchievements=t},ToggleSettings(e,t){note("ToggleSettings(event, "+t+") called"),e.stopPropagation(),e.preventDefault(),this.ResetModalContentScrollPositions(),this.appVisualStateShowPageSettings=t,this.ToggleGamePause(e,t)},ToggleCredits(e,t){note("ToggleCredits(event, value) called"),e.stopPropagation(),e.preventDefault(),this.ResetModalContentScrollPositions(),this.appVisualStateShowPageCredits=t},GetUserSettings(){note("GetUserSettings() called");let e=localStorage.getItem("appSettingsModes");null!=e&&(e=JSON.parse(e),null!=e.easy&&null!=e.easy?(this.GetModeById("normal").isSelected=e.infinite.isSelected,this.GetModeById("normal").isSelected=e.easy.isSelected):e.forEach((e=>{this.appSettingsModes.forEach((t=>{t.id===e.id&&(t.isSelected=e.isSelected)}))})));let t=localStorage.getItem("appTutorialUserHasSeen");highlight("setting OOBE tutorial based on local storage"),t&&warn(t),null!=t?(t=JSON.parse(t),t?this.appTutorialUserHasSeen=!0:this.ToggleHowToPlay()):this.ToggleHowToPlay();let a=localStorage.getItem("userRank");note("setting userRank from local storage"),null!=a&&"undefined"!==a?this.SetUserBasedOnRank(parseInt(a)):this.SetUserBasedOnRank(parseInt(0));let s=localStorage.getItem("userSettingsUseHardCoreMode");null!=s&&(this.userSettingsUseHardCoreMode=JSON.parse(s));let r=localStorage.getItem("userNumberOfPerfectBasicGames");null!=r&&(r=JSON.parse(r),this.userNumberOfPerfectBasicGames=r);let i=localStorage.getItem("userSettingsUseHints");null!=i&&(i=JSON.parse(i),this.userSettingsUseHints=i);let n=localStorage.getItem("userSettingsUseCats");null!=n&&(n=JSON.parse(n),this.userSettingsUseCats=n);let o=localStorage.getItem("userSettingsUseAltPatterns");null!=o&&(o=JSON.parse(o),this.userSettingsUseAltPatterns=o);let l=localStorage.getItem("userSettingsUseSoundFX");null!=l&&(l=JSON.parse(l),this.userSettingsUseSoundFX=l);let h=localStorage.getItem("userSettingsPlayMusic");null!=h&&(h=JSON.parse(h),this.userSettingsPlayMusic=h);let g=localStorage.getItem("userSettingsUseDarkMode");null!=g&&(g=JSON.parse(g),this.userSettingsUseDarkMode=g,document.getElementById("themeColor").content=this.userSettingsUseDarkMode?"#000000":"#f0f0f0");let u=localStorage.getItem("userSettingsTheme");try{let e="";null!=u&&(u=JSON.parse(u),this.appSettingsThemes.forEach((t=>{t.name==u&&(e=t)}))),""!=e&&this.SelectTheme(e)}catch(e){error("_userSettingsTheme error: "+e),_gameDataCorrupt=!0}let c=localStorage.getItem("userHighScoresEasy");try{null!=c&&"[]"!==c&&(c=JSON.parse(c),c.forEach((e=>{this.userHighScoresEasy.push(new ScoreObject({modeId:null==e.modeId?"":e.modeId,modeName:null==e.modeName?"":e.modeName,streak:null==e.streak?0:e.streak,numberOfClears:null==e.numberOfClears?0:e.numberOfClears,numberOfPerfectClears:null==e.numberOfPerfectClears?0:e.numberOfPerfectClears,date:new Date(e.date),isDaily:e.isDaily,rankId:e.rankId,value:e.value,dailyDate:null!=e.dailyDate?new Date(e.dailyDate):new Date(e.date)}))})))}catch(e){error("_userHighScoresEasy error: "+e),_gameDataCorrupt=!0}let m=localStorage.getItem("gameCurrentHasAnyPieceEverBeenSelected");try{null!=m&&(this.gameCurrentHasAnyPieceEverBeenSelected=JSON.parse(m))}catch(e){error("_gameCurrentHasAnyPieceEverBeenSelected error: "+e),_gameDataCorrupt=!0}let S=localStorage.getItem("gameLikenessNudgeHasBeenShown");try{null!=S&&(this.gameLikenessNudgeHasBeenShown=!0===JSON.parse(S))}catch(e){error("_gameLikenessNudgeHasBeenShown error: "+e),_gameDataCorrupt=!0}let d=localStorage.getItem("gameClickMeNudgeHasBeenShown");try{null!=d&&(this.gameClickMeNudgeHasBeenShown=!0===JSON.parse(d))}catch(e){error("_gameClickMeNudgeHasBeenShown error: "+e),_gameDataCorrupt=!0}},ClearAllUserScores(){note("ClearAllUserScores() called"),window.confirm("Are you sure you want to clear all of your scores?")&&(this.appVisualStateShowNotification=!1,this.gameLastHighScore=new ScoreObject({}),this.gameScoreToShare=new ScoreObject({}),this.userHighScoresEasy=[],this.userHighScoresInfinite=[],this.gameDailyChallenge.allLevels=[],this.gameCurrentIsGameDailyChallenge=!1,this.userNumberOfPerfectBasicGames=0,localStorage.setItem("userNumberOfPerfectBasicGames",this.userNumberOfPerfectBasicGames),localStorage.setItem("userHighScoresEasy",JSON.stringify(this.userHighScoresEasy)),localStorage.setItem("userHighScoresInfinite",JSON.stringify(this.userHighScoresInfinite)),this.GetDailyChallenge())},RestoreCurrentGame(){note("RestoreCurrentGame() called");let e=!1,t=localStorage.getItem("appSettingsModeIntervalIncrement");try{null!=t&&(this.appSettingsModeIntervalIncrement=t)}catch(t){error("_appSettingsModeIntervalIncrement error: "+t),e=!0}let a=localStorage.getItem("appSettingsPieceSize");try{null!=a&&(this.appSettingsPieceSize=a)}catch(t){error("_appSettingsPieceSize error: "+t),e=!0}let s=localStorage.getItem("appSettingsTotalNumberOfBoardPieces");try{null!=s&&(this.appSettingsTotalNumberOfBoardPieces=s)}catch(t){error("_appSettingsTotalNumberOfBoardPieces error: "+t),e=!0}let r=localStorage.getItem("appSettingsBoardGridSize");try{null!=r&&(this.appSettingsBoardGridSize=r)}catch(t){error("_appSettingsBoardGridSize error: "+t),e=!0}let i=localStorage.getItem("appVisualStateShowPageHome");try{null!=i&&(this.appVisualStateShowPageHome=JSON.parse(i))}catch(t){error("_appVisualStateShowPageHome error: "+t),e=!0}let n=localStorage.getItem("appVisualStateShowPageHowToPlay");try{null!=n&&(this.appVisualStateShowPageHowToPlay=JSON.parse(n))}catch(t){error("_appVisualStateShowPageHowToPlay error: "+t),e=!0}let o=localStorage.getItem("appVisualStateShowPageSettings");try{null!=o&&(this.appVisualStateShowPageSettings=JSON.parse(o))}catch(t){error("_appVisualStateShowPageSettings error: "+t),e=!0}let l=localStorage.getItem("appVisualStateShowElementHint");try{null!=l&&(this.appVisualStateShowElementHint=JSON.parse(l))}catch(t){error("_appVisualStateShowElementHint error: "+t),e=!0}let h=localStorage.getItem("appVisualStateShowElementFlyaway");try{null!=h&&(this.appVisualStateShowElementFlyaway=JSON.parse(h))}catch(t){error("_appVisualStateShowElementFlyaway error: "+t),e=!0}let g=localStorage.getItem("gameCurrentIsPaused");try{null!=g&&(g=JSON.parse(g),this.gameCurrentIsPaused=g)}catch(t){error("_gameCurrentIsPaused error: "+t),e=!0}let u=localStorage.getItem("gameDailyChallenge");try{null!=u&&(u=JSON.parse(u),_letAllLevels=new AllLevelsObject({date:new Date(u.date)}),u.allLevels.forEach((e=>{let t=new SingleLevelObject({me:e.me,completed:e.completed});e.board.forEach((e=>{t.board.push(new PieceObject(e))})),_letAllLevels.allLevels.push(t)})),this.gameDailyChallenge=_letAllLevels)}catch(t){error("_gameDailyChallenge error: "+t),e=!0}let c=localStorage.getItem("gameCurrentIsGameDailyChallenge");try{null!=c&&(c=JSON.parse(c),this.gameCurrentIsGameDailyChallenge=c)}catch(t){error("_gameCurrentIsGameDailyChallenge error: "+t),e=!0}let m=localStorage.getItem("gameDailyChallengeHasBeenStarted");try{null!=m&&(m=JSON.parse(m),this.gameDailyChallengeHasBeenStarted=m)}catch(t){error("_gameDailyChallengeHasBeenStarted error: "+t),e=!0}let S=localStorage.getItem("gameCurrentAllLevels");try{null!=S&&(S=JSON.parse(S),this.gameCurrentAllLevels=S)}catch(t){error("_gameCurrentAllLevels error: "+t),e=!0}let d=localStorage.getItem("gameCurrentLevel");try{if(null!=d){d=JSON.parse(d);let e=new SingleLevelObject({me:d.me,completed:d.completed});if(this.gameCurrentIsGameDailyChallenge)for(let t=0;t<this.gameDailyChallenge.allLevels.length;t++){const a=this.gameDailyChallenge.allLevels[t];if(!a.completed){e=a;break}}else d.board.forEach((t=>{e.board.push(new PieceObject(t))}));this.gameCurrentLevel=e}}catch(t){error("_gameCurrentLevel error: "+t),e=!0}let p=localStorage.getItem("gameCurrentMePiece");try{null!=p&&(p=JSON.parse(p),this.gameCurrentMePiece=new PieceObject(p))}catch(t){error("_gameCurrentMePiece error: "+t),e=!0}let C=localStorage.getItem("gameCurrentBoardPieces");try{null!=C&&(C=JSON.parse(C),this.gameCurrentBoardPieces=[],C.forEach((e=>{this.gameCurrentBoardPieces.push(new PieceObject(e))})))}catch(t){error("_gameCurrentBoardPieces error: "+t),e=!0}let y=localStorage.getItem("gameCurrentStartingTime");try{null!=y&&(this.gameCurrentStartingTime=y)}catch(t){error("_gameCurrentStartingTime error: "+t),e=!0}let f=localStorage.getItem("gameCurrentTimer");try{null!=f&&(this.gameCurrentTimer=f)}catch(t){error("_gameCurrentTimer error: "+t),e=!0}let I=localStorage.getItem("gameCurrentNumberOfClears");try{null!=I&&(this.gameCurrentNumberOfClears=I)}catch(t){error("_gameCurrentNumberOfClears error: "+t),e=!0}let w=localStorage.getItem("gameCurrentNumberOfPerfectMatches");try{null!=w&&(this.gameCurrentNumberOfPerfectMatches=w)}catch(t){error("_gameCurrentNumberOfPerfectMatches error: "+t),e=!0}let P=localStorage.getItem("gameCurrentIsUserGuessWrong");try{null!=P&&(this.gameCurrentIsUserGuessWrong=JSON.parse(P))}catch(t){error("_gameCurrentIsUserGuessWrong error: "+t),e=!0}let v=localStorage.getItem("gameCurrentNumberOfFails");try{null!=v&&(this.gameCurrentNumberOfFails=v)}catch(t){error("_gameCurrentNumberOfFails error: "+t),e=!0}let H=localStorage.getItem("gameCurrentNumberOfMisses");try{null!=H&&(this.gameCurrentNumberOfMisses=H)}catch(t){error("_gameCurrentNumberOfMisses error: "+t),e=!0}let T=localStorage.getItem("gameCurrentHintText");try{null!=T&&(this.gameCurrentHintText=T)}catch(t){error("_gameCurrentHintText error: "+t),e=!0}let b=localStorage.getItem("gameCurrentTotalScore");try{null!=b&&(this.gameCurrentTotalScore=parseInt(b))}catch(t){error("_gameCurrentTotalScore error: "+t),e=!0}this.CheckIfUserHasScoredDailyChallenge(),e&&(this.gameCurrentIsGameOver=!0,this.NewGame())},GetRandomWallpaper(){note("GetRandomWallpaper() called"),this.currentWallpaper=this.wallpaperNames[getRandomInt(0,this.wallpaperNames.length)],document.getElementsByTagName("wallpaper")[0].className=this.currentWallpaper},InitializeGame(){announce("Game Initialized"),this.AdjustPieceSizeBasedOnViewport(),this.CheckIfGameIsInNativeAppWebView(),this.CheckForMobile(),this.GetRandomWallpaper();let e=localStorage.getItem("onemoretime");try{null!=e&&(e=JSON.parse(e),e&&localStorage.setItem("onemoretime",!1))}catch(e){error("_onemoretime error: "+e)}let t=localStorage.getItem("storedVersion");try{null!=t&&(this.storedVersion=t)}catch(e){t=null}let a=localStorage.getItem("userCurrency");try{if(null!=a){let e=JSON.parse(a);this.userCurrency.forEach((t=>{let a=e.find((e=>e.id===t.id));t.count=a.count}))}}catch(e){error("_userCurrency error: "+e)}let s=localStorage.getItem("userSettingsActionItems");try{if(null!=s){let e=JSON.parse(s);this.userSettingsActionItems.forEach((t=>{let a=e.find((e=>e.id===t.id));t.count=a.count}))}}catch(e){error("_userSettingsActionItems error: "+e)}let r=localStorage.getItem("gameCurrentIsGameOver");try{null!=r&&(this.gameCurrentIsGameOver=JSON.parse(r))}catch(e){this.gameCurrentIsGameOver=!0}this.GetUserSettings(),this.gameCurrentIsGameOver||this.RestoreCurrentGame(),this.appSettingsInfiniteMode=null===this.appSettingsInfiniteMode?this.GetModeById("infinite"):this.appSettingsInfiniteMode,this.appSettingsCurrentGameMode=null===this.appSettingsCurrentGameMode?this.GetCurrentGameMode():this.appSettingsCurrentGameMode,this.updateInterval=window.setInterval(this.UpdateApp,this.appSettingsModeIntervalIncrement)},HandleOnPageHideEvent(e=!0){this.appIsBeingReset||(e&&window.clearInterval(this.updateInterval),this.appSettingsSaveSettings&&(localStorage.setItem("storedVersion",this.currentVersion),localStorage.setItem("appSettingsModes",JSON.stringify(this.appSettingsModes)),localStorage.setItem("appSettingsModeIntervalIncrement",this.appSettingsModeIntervalIncrement),localStorage.setItem("appSettingsPieceSize",this.appSettingsPieceSize),localStorage.setItem("appSettingsTotalNumberOfBoardPieces",this.appSettingsTotalNumberOfBoardPieces),localStorage.setItem("appSettingsBoardGridSize",this.appSettingsBoardGridSize),localStorage.setItem("appVisualStateShowPageHome",JSON.stringify(this.appVisualStateShowPageHome)),localStorage.setItem("appVisualStateShowPageHowToPlay",JSON.stringify(this.appVisualStateShowPageHowToPlay)),localStorage.setItem("appVisualStateShowPageSettings",JSON.stringify(this.appVisualStateShowPageSettings)),localStorage.setItem("appVisualStateShowElementHint",JSON.stringify(this.appVisualStateShowElementHint)),localStorage.setItem("appVisualStateShowElementFlyaway",JSON.stringify(this.appVisualStateShowElementFlyaway)),localStorage.setItem("gameDailyChallenge",JSON.stringify(this.gameDailyChallenge)),localStorage.setItem("gameCurrentIsGameDailyChallenge",JSON.stringify(this.gameCurrentIsGameDailyChallenge)),localStorage.setItem("gameDailyChallengeHasBeenStarted",JSON.stringify(this.gameDailyChallengeHasBeenStarted)),localStorage.setItem("gameCurrentAllLevels",JSON.stringify(this.gameCurrentAllLevels)),localStorage.setItem("gameCurrentLevel",JSON.stringify(this.gameCurrentLevel)),localStorage.setItem("gameCurrentIsGameOver",JSON.stringify(this.gameCurrentIsGameOver)),localStorage.setItem("gameCurrentMePiece",JSON.stringify(this.gameCurrentMePiece)),localStorage.setItem("gameCurrentBoardPieces",JSON.stringify(this.gameCurrentBoardPieces)),localStorage.setItem("gameCurrentStartingTime",this.gameCurrentStartingTime),localStorage.setItem("gameCurrentTimer",this.gameCurrentTimer),localStorage.setItem("gameCurrentNumberOfClears",this.gameCurrentNumberOfClears),localStorage.setItem("gameCurrentNumberOfPerfectMatches",this.gameCurrentNumberOfPerfectMatches),localStorage.setItem("gameCurrentIsUserGuessWrong",JSON.stringify(this.gameCurrentIsUserGuessWrong)),localStorage.setItem("gameCurrentNumberOfFails",this.gameCurrentNumberOfFails),localStorage.setItem("gameCurrentNumberOfMisses",this.gameCurrentNumberOfMisses),localStorage.setItem("gameCurrentHintText",this.gameCurrentHintText),localStorage.setItem("gameCurrentTotalScore",this.gameCurrentTotalScore),localStorage.setItem("gameCurrentHasAnyPieceEverBeenSelected",JSON.stringify(this.gameCurrentHasAnyPieceEverBeenSelected)),localStorage.setItem("gameLikenessNudgeHasBeenShown",JSON.stringify(this.gameLikenessNudgeHasBeenShown)),localStorage.setItem("gameClickMeNudgeHasBeenShown",JSON.stringify(this.gameClickMeNudgeHasBeenShown)),localStorage.setItem("userHighScoresEasy",JSON.stringify(this.userHighScoresEasy)),localStorage.setItem("userSettingsUseCats",this.userSettingsUseCats),localStorage.setItem("userSettingsUseAltPatterns",this.userSettingsUseAltPatterns),localStorage.setItem("userSettingsUseHints",this.userSettingsUseHints),localStorage.setItem("userSettingsUseSoundFX",this.userSettingsUseSoundFX),localStorage.setItem("userSettingsPlayMusic",this.userSettingsPlayMusic),localStorage.setItem("userSettingsUseDarkMode",this.userSettingsUseDarkMode),localStorage.setItem("userRank",this.userRank),localStorage.setItem("userNumberOfPerfectBasicGames",this.userNumberOfPerfectBasicGames),this.appSettingsEnableEconomy&&(localStorage.setItem("userCurrency",JSON.stringify(this.userCurrency)),localStorage.setItem("userSettingsActionItems",JSON.stringify(this.userSettingsActionItems)))))},ChangeTutorialPiecesToCats(e){let t=e.replace("pieces","cats");return this.userSettingsUseCats?t:e},HandleActionItemClick(e){if(note("HandleActionItemClick() called"),this.appSettingsEnableEconomy&&e.count>0){switch(e.count--,e.id){case 1:this.IdentifyMismatches();break;case 2:this.ResetLevel();break;case 3:this.AddTimeBonus(1e4);break;case 4:this.ClearLevel();break;case 5:this.AddTimeBonus(3e4);break;default:break}localStorage.setItem("userSettingsActionItems",JSON.stringify(this.userSettingsActionItems))}},IdentifyMismatches(){note("IdentifyMismatches() called");let e=!1;this.gameCurrentBoardPieces.forEach((t=>{t.nudge=!1,!e&&(t.isMatch&&!t.isSelected||!t.isMatch&&t.isSelected)&&(t.nudge=!0,e=!0)}))},ResetLevel(){note("ResetLevel() called"),this.gameCurrentBoardPieces.forEach((e=>{e.isSelected=!1,e.nudge=!1})),this.gameCurrentNumberOfMisses=0},AddTimeBonus(e=3e3){note("AddTimeBonus() called"),this.appSettingsCurrentGameMode.bonustime=e,this.gameCurrentTimer=this.gameCurrentTimer+this.appSettingsCurrentGameMode.bonustime,this.appSettingsCurrentGameMode.bonustime>0&&(this.appVisualStateShowElementFlyaway=!0,window.setTimeout((function(){app.appVisualStateShowElementFlyaway=!1}),100))},ClearLevel(){note("ClearLevel() called"),this.ResetLevel(),this.gameCurrentBoardPieces.forEach((e=>{e.isSelected=e.isMatch})),this.CheckBoard()},AdjustItemCount(e,t,a,s){note("AdjustItemCount() called"),e.stopPropagation(),e.preventDefault();let r=a.count+s,i=t.count+-1*a.cost*s;i>=0&&r>=0&&r<=a.maxCount&&(t.count=i,a.count=r),localStorage.setItem("userCurrency",JSON.stringify(this.userCurrency)),localStorage.setItem("userSettingsActionItems",JSON.stringify(this.userSettingsActionItems))},HandleSkipTutorial(){note("HandleSkipTutorial() called"),this.userTutorialCheckCount=0,this.appTutorialIsInPlay=!1,this.appTutorialCurrentStepIndex=0,this.appTutorialUserHasSeen=!0,localStorage.setItem("appTutorialUserHasSeen",!0)},HandleDoneTutorial(){note("HandleDoneTutorial() called"),this.appTutorialUserHasSeen||this.RestartGame(),this.HandleSkipTutorial()},HandleTutorialNext(){note("HandleTutorialNext() called"),this.appTutorialCurrentStepIndex++},HandleTutorialBack(){note("HandleTutorialBack() called"),this.appTutorialCurrentStepIndex>0&&this.appTutorialCurrentStepIndex--},HandleTutorialCheck(){if(note("HandleTutorialCheck() called"),this.appTutorialCurrentStepIndex>3){this.userTutorialCheckCount++;let e=!0;this.appTutorialBoardPieces.board.forEach(((t,a)=>{(a<4&&!t.isSelected||a>=4&&t.isSelected)&&(e=!1)})),e?(this.appTutorialBoardPieces.board.forEach(((e,t)=>{e.isSelected=!1})),this.HandleTutorialNext()):(this.userTutorialCheckCount>2&&this.appTutorialBoardPieces.board.forEach(((e,t)=>{e.isSelected=e.isMatch})),this.gameCurrentIsUserGuessWrong=!0,window.setTimeout((function(){app.gameCurrentIsUserGuessWrong=!1}),500))}log("this.userTutorialCheckCount = "+this.userTutorialCheckCount)},HandleOnPageShowEvent(){note("HandleOnPageShowEvent() called"),this.appVisualStateShowGameOverContent=!0,this.appSettingsInfiniteMode=null===this.appSettingsInfiniteMode?this.GetModeById("infinite"):this.appSettingsInfiniteMode,this.appSettingsCurrentGameMode=null===this.appSettingsCurrentGameMode?this.GetCurrentGameMode():this.appSettingsCurrentGameMode,window.clearInterval(this.updateInterval),this.updateInterval=window.setInterval(this.UpdateApp,this.appSettingsModeIntervalIncrement),this.GetDailyChallenge(),this.CheckForServiceWorkerUpdate()},HandleTouchApp(){note("HandleTouchApp() called"),this.appSettingsThemeSong.playing()||"loaded"!==this.appSettingsThemeSong.state()||this.appTutorialIsInPlay||!this.userSettingsPlayMusic||(this.appSettingsThemeSong.volume(0),this.appSettingsThemeSong.play(),this.appSettingsThemeSong.fade(0,this.userSettingsMusicVolume,1e3))},CheckForServiceWorkerUpdate(){note("CheckForServiceWorkerUpdate() called"),"serviceWorker"in navigator&&navigator.serviceWorker.getRegistrations().then((function(e){for(let t of e)t.update()}))},CheckIfGameIsInNativeAppWebView(){return note("CheckIfGameIsInNativeAppWebView() called"),this.isInNativeAppWebView=null!==document.cookie.match(/^(.*;)?\s*app-platform\s*=\s*[^;]+(.*)?$/),this.isInNativeAppWebView||(this.isInNativeAppWebView=-1!==window.location.search.indexOf("googleplay")),this.isInNativeAppWebView},CheckLocalStorageSize(){var e,t=0;for(e in localStorage)localStorage.hasOwnProperty(e)&&(t+=2*(localStorage[e].length+e.length));return"Total = "+(t/1024).toFixed(2)+" KB"},HandleOnVisibilityChange(e){if(note("HandleOnVisibilityChange() called"),this.appVisualStateShowGameOverContent=!0,this.HandleOnPageHideEvent(),document.hidden)this.userSettingsPlayMusic&&this.appSettingsThemeSong.fade(this.userSettingsMusicVolume,0,1e3),this.splashBoard&&(this.splashBoard=!1,this.EndGame(),this.HandleOnResizeEvent());else{log("document visible");const{ctx:e}=Howler;e&&!document.hidden&&setTimeout((()=>{e.resume()}),100),this.userSettingsPlayMusic&&this.appSettingsThemeSong.fade(0,this.userSettingsMusicVolume,1e3)}this.CheckIfGameIsInNativeAppWebView(),this.GetDailyChallenge(),this.CheckForServiceWorkerUpdate(),window.clearInterval(this.updateInterval),this.updateInterval=window.setInterval(this.UpdateApp,this.appSettingsModeIntervalIncrement)},AdjustPieceSizeBasedOnViewport(){this.splashBoard||(this.appSettingsPieceSize=window.innerWidth<450?(window.innerWidth-60)/this.appSettingsBoardGridSize+"px":400/this.appSettingsBoardGridSize+"px",this.documentCssRoot.style.setProperty("--pieceSize",this.appSettingsPieceSize),this.appSettingsTotalNumberOfBoardPieces=window.innerHeight<234?12:16)},async GetDailyChallenge(){note("GetDailyChallenge() 2 called");let e=new Date;if(!this.gameCurrentIsGameDailyChallenge&&(0===this.gameDailyChallenge.allLevels.length||this.GetMonthAndDay(this.gameDailyChallenge.date)!==this.GetMonthAndDay(e))){this.gameDailyChallenge=new AllLevelsObject({});let t=parseInt(e.toLocaleDateString("en-UK").replace(/\//g,""));constructAllLevels(this.GenerateNumbers(t),this.gameDailyChallenge)}app.CheckIfUserHasScoredDailyChallenge(!0)},GenerateNumbers(e){for(var t=new Math.seedrandom(e),a=[],s=0;s<parseInt(this.getCurrentPlayerRank.levels);s++){for(var r="",i=0;i<51;i++){r+=(i%3==2?Math.floor(4*t())+1:Math.floor(3*t())+1).toString()}a+=r}return a},FillBoardWithPieces(e=this.appSettingsPieceSize){if(UseDebug){let t=this.GenerateNumbers();this.HandleSkipTutorial(),this.SelectMode(this.getInfiniteModeComputed),this.RestartGame(),this.documentCssRoot.style.setProperty("--pieceSize",e);let a=constructLevel(t,!0);this.gameCurrentBoardPieces=a.board,this.splashBoard=!0,document.getElementsByTagName("wallpaper")[0].style.backgroundColor="black",document.getElementsByTagName("wallpaper")[0].style.opacity=.8}},StartDailyChallenge(){note("StartDailyChallenge() called"),this.usersModeBeforeDailyChallenge=this.getCurrentGameModeComputed,this.SelectMode(this.GetModeById("normal")),this.gameDailyChallengeHasBeenStarted=!0,this.gameCurrentIsGameDailyChallenge=!0,this.RestartGame()},HandleOnResizeEvent(){this.AdjustPieceSizeBasedOnViewport()},FormatDate:e=>new Date(e).toLocaleDateString(),GetMonthAndDay(e){const t=new Date(e);return`${t.toLocaleString("default",{month:"short"})} ${t.getDate()}`},NumberWithCommas:e=>e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","),CheckForMobile(){let e="ontouchstart"in document.documentElement;return this.deviceHasTouch=e,e},HandleKeyUp(e){note("HandleKeyUp(event) called");let t=-1;switch(this.appSettingsThemes.forEach(((e,a)=>{e.isSelected&&(t=a)})),e.key){case"]":t=t==this.appSettingsThemes.length-1?0:t+1,this.SelectTheme(this.appSettingsThemes[t]);break;case"[":t=0==t?this.appSettingsThemes.length-1:t-1,this.SelectTheme(this.appSettingsThemes[t]);break;case"/":this.ToggleUsingDarkMode();break;case"c":this.ToggleUsingCats();break;case"p":this.ToggleUsingAltPattern();break;case"1":case"2":case"3":case"4":break;case" ":case"Enter":e.preventDefault(),this.appTutorialIsInPlay||this.gameCurrentIsGameOver||this.appVisualStateShowPageChallenge?!this.gameCurrentIsGameOver&&this.appVisualStateShowPageChallenge?this.EndGame():this.appTutorialIsInPlay&&(this.appTutorialCurrentStepIndex<this.appTutorialSteps.length-1?this.HandleTutorialNext():this.gameCurrentIsGameOver&&this.HandleSkipTutorial()):this.CheckBoard();break;case"Escape":this.ClearEphemeralVisualStates();break}},HandleKeyDown(e){switch(e.key){case" ":case"Enter":e.preventDefault();break}},ClearEphemeralVisualStates(){note("ClearEphemeralVisualStates() called"),this.RemoveConfetti(),this.gameConfettiCount=0,this.appVisualStateShowNotification=!1,this.appVisualStateShowElementHint=!1,this.appVisualStateShowPageManageCurrency=!1,this.tempPerfectBasicGames=this.userNumberOfPerfectBasicGames,this.gameCurrentIsGameOver&&(this.appVisualStateShowPageHome=!0),this.appTutorialIsInPlay&&this.HandleSkipTutorial(),this.appVisualStateShowGameOverContent=!0,this.appVisualStateShowPageSettings=!1,this.appVisualStateShowPageHighScores=!1,this.appVisualStateShowPageAchievements=!1,this.appVisualStateShowPageHowToPlay=!1,this.appVisualStateShowPageCredits=!1,this.appVisualStateShowPageChallenge=!1,this.appVisualStateShowElementHint=!1,this.appVisualStateShowPageGameOver=!1},HandleUpdateAppButtonClick(){note("HandleUpdateAppButtonClick() called"),this.newVersionAvailable=!1,""!==this.serviceWorker?this.serviceWorker.postMessage({action:"skipWaiting"}):window.location.reload(!0)},HandleServiceWorkerRegistration(){note("HandleServiceWorkerRegistration() called"),"serviceWorker"in navigator&&navigator.serviceWorker.register("./sw.js").then((e=>{e.addEventListener("updatefound",(()=>{this.serviceWorker=e.installing,this.serviceWorker.addEventListener("statechange",(()=>{switch(this.serviceWorker.state){case"installed":navigator.serviceWorker.controller&&(this.newVersionAvailable=!0);break}}))}))}))}},mounted(){if(this.HandleServiceWorkerRegistration(),this.InitializeGame(),window.addEventListener("keyup",this.HandleKeyUp),window.addEventListener("keydown",this.HandleKeyDown),window.addEventListener("pageshow",this.HandleOnPageShowEvent),window.addEventListener("visibilitychange",this.HandleOnVisibilityChange),window.addEventListener("pagehide",this.HandleOnPageHideEvent),window.addEventListener("resize",this.HandleOnResizeEvent),null!=navigator.serviceWorker){let e;navigator.serviceWorker.addEventListener("message",this.HandleServiceWorkerWaiting),navigator.serviceWorker.addEventListener("controllerchange",(function(){e||(localStorage.setItem("onemoretime",!0),window.location.reload(),e=!0)}))}},computed:{userScoresHighEasyByValue:function(){return note("userScoresHighEasyByValue() called"),this.userHighScoresEasy.filter((e=>!e.isDaily)).sort((function(e,t){return e.value<t.value?1:e.value>t.value?-1:0})).flat().slice(0,this.appSettingsNumberOfHighScoresShown)},userScoresHighDailyByDate:function(){return note("userScoresHighDailyByDate() called"),this.userHighScoresEasy.filter((e=>e.isDaily)).sort((function(e,t){return e.date<t.date?1:e.date>t.date?-1:0})).flat().slice(0,this.appSettingsNumberOfHighScoresShown)},userScoresHighInfiniteByValue:function(){return note("userScoresHighInfiniteByValue() called"),this.userHighScoresInfinite.sort((function(e,t){return e.value<t.value?1:e.value>t.value?-1:0})).flat().slice(0,this.appSettingsNumberOfHighScoresShown)},userScoresHighDailyByValue:function(){return note("userScoresHighDailyByValue() called"),this.userHighScoresEasy.filter((e=>e.isDaily)).sort((function(e,t){return e.value<t.value?1:e.value>t.value?-1:0})).flat().slice(0,this.appSettingsNumberOfHighScoresShown)},userHasDoneTodaysDailyChallenge:function(){const e=(new Date).toDateString();return this.userHighScoresEasy.some((t=>new Date(t.dailyDate).toDateString()===e&&t.isDaily))},getCurrentGameModeComputed:function(){return note("getCurrentGameModeComputed() called"),this.GetCurrentGameMode()},getInfiniteModeComputed:function(){return note("getInfiniteModeComputed() called"),this.GetModeById("infinite")},getNormalModeComputed:function(){return note("getNormalModeComputed() called"),this.GetModeById("normal")},getCurrentPlayerRank:function(){return note("getCurrentPlayerRank() called"),this.allPlayerRanks.find((e=>e.rank===this.userRank))},getLastHighScoreRank:function(){return note("getLastHighScoreRank() called"),this.GetRankById(this.gameLastHighScore.rankId)},getNextPlayerRank:function(){return note("getNextPlayerRank() called"),this.allPlayerRanks.find((e=>e.rank===parseInt(this.userRank+1)))},getLastRank:function(){return note("getLastRank() called"),this.allPlayerRanks[this.allPlayerRanks.length-1]},getGameOverTitle:function(){note("getGameOverTitle() called");let e="";return this.getNormalModeComputed.isSelected?(e="Game over",this.gameLastHighScore.numberOfPerfectClears===this.gameLastHighScore.totalPossibleClears&&(e="PERFECT!",this.gameCurrentJustRankedUp&&this.userNumberOfPerfectBasicGames<3&&(e="<span class='ranktext'>"+this.getCurrentPlayerRank.name+" unlocked!!</span>"))):e=this.gameLastHighScore.numberOfClears>0?"Success":"No worry",e},getGameOverSubtitle:function(){note("getGameOverSubtitle() called");let e="";return this.getNormalModeComputed.isSelected?this.gameLastHighScore.isDaily&&!this.appVisualStateShowNewHighScoreElement?e="Daily - "+this.GetMonthAndDay(this.gameLastHighScore.dailyDate):!this.userSettingsUseHardCoreMode&&this.userNumberOfPerfectBasicGames>=3?e="Hardcore Mode Unlocked!":this.gameLastHighScore.isDaily||this.appVisualStateShowNewHighScoreElement||(e=this.gameLastHighScore.numberOfPerfectClears===this.gameLastHighScore.totalPossibleClears?"Very nicely done.":"Better luck next time!"):e=this.gameLastHighScore.numberOfClears>0?"You are present and connected.":"There will always be time.",e},getHomePageRankSubcredit:function(){note("getHomePageRankSubcredit() called");let e="";return!this.userSettingsUseHardCoreMode&&this.userNumberOfPerfectBasicGames<3&&void 0!==this.getNextPlayerRank?e="Next rank: &rdquo;"+this.getNextPlayerRank.name+"&ldquo;":!this.userSettingsUseHardCoreMode&&this.userNumberOfPerfectBasicGames<3&&void 0===this.getNextPlayerRank?e="The next rank is a mystery!":!this.userSettingsUseHardCoreMode&&this.userNumberOfPerfectBasicGames>=3?e="Hardcore Mode Unlocked!":this.userSettingsUseHardCoreMode&&this.userNumberOfPerfectBasicGames<3&&void 0!==this.getNextPlayerRank&&(e="Next Hardcore rank: &rdquo;"+this.getNextPlayerRank.name+"&ldquo;"),e},getRankPageSubcredt:function(){note("getRankPageSubcredt() called");let e="";return!this.userSettingsUseHardCoreMode&&this.userNumberOfPerfectBasicGames<3?e="Get 3 perfect games to unlock the next rank. Perfect games are only earned when every level in that game is cleared on the <b>first</b> attempt.":!this.userSettingsUseHardCoreMode&&this.userRank===this.getLastRank.rank&&this.userNumberOfPerfectBasicGames>=3?e="Amazing! You've done at least 3 perfect games as a <b>"+this.getLastRank.name+"</b> But if you truly want a challenge, enable Hardcore mode and start over.":this.userSettingsUseHardCoreMode&&this.userRank<this.getLastRank.rank?e="Get 3 perfect games in a row to unlock the next rank. Perfect games are only earned when every level in that game is cleared on the <b>first</b> attempt.":this.userSettingsUseHardCoreMode&&this.userRank===this.getLastRank.rank&&this.userNumberOfPerfectBasicGames<3?e="Wow! It takes some serious skill to achieve the <b>"+this.getLastRank.name+"</b> rank while in Hardcore Mode.":this.userSettingsUseHardCoreMode&&this.userRank===this.getLastRank.rank&&this.userNumberOfPerfectBasicGames>=3&&(e=this.appSettingsHardcoreFinishedEmoji+" You are beyond impressive: <br /><b>"+this.getLastRank.name+"</b> rank while in Hardcore Mode with at least 3 consecutive perfect games. <br />They should sing songs about you!"),e},getNextRankRequirementsText:function(){note("getRankPageSubcredt() called");let e="";return this.userRank!==this.getLastRank.rank?e="Just "+(3-this.userNumberOfPerfectBasicGames)+" more perfect "+(2===this.userNumberOfPerfectBasicGames?"game":"games")+" till the next Rank":!this.userSettingsUseHardCoreMode&&this.userRank===this.getLastRank.rank&&this.userNumberOfPerfectBasicGames<3&&(e="Just "+(3-this.userNumberOfPerfectBasicGames)+" more perfect "+(2===this.userNumberOfPerfectBasicGames?"game":"games")),e},getCurrencies:function(){return note("getCurrencies() called"),this.userCurrency.filter((e=>e.isEnabled))},getFirstTwoItemsSortedByOrder:function(){return note("getFirstTwoItemsSortedByOrder() called"),[this.userSettingsActionItems[0],this.userSettingsActionItems[1]]},getSecondTwoItemsSortedByOrder:function(){return note("getSecondTwoItemsSortedByOrder() called"),[this.userSettingsActionItems[2],this.userSettingsActionItems[3]]},getItemsSortedByCost:function(){return note("getItemsSortedByCost() called"),this.userSettingsActionItems.sort((function(e,t){return e.cost>t.cost?1:e.cost<t.cost?-1:0}))}}});